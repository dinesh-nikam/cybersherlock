"use strict";(()=>{var e={};e.id=481,e.ids=[481],e.modules={21:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{default:()=>P});var o=t(9646),n=t(9021),a=t.n(n),i=t(6566),u=t.n(i),d=t(7129),p=t.n(d),l=t(5035),c=t(818),f=t.n(c),A=e([l]);l=(A.then?(await A)():A)[0],f().config();let h={shodanApiKey:process.env.SHODAN_API_KEY,censysApiKey:process.env.CENSYS_API_KEY,censysApiSecret:process.env.CENSYS_API_SECRET,greynoiseApiKey:process.env.GREYNOISE_API_KEY,ipinfoApiKey:process.env.IPINFO_API_KEY,virustotalApiKey:process.env.VIRUSTOTAL_API_KEY,abuseipdbApiKey:process.env.ABUSEIPDB_API_KEY,securitytrailsApiKey:process.env.SECURITYTRAILS_API_KEY};async function P(e,r){if("POST"===e.method){let{ip:t,target:s,type:n}=e.body;if(!n)return console.error("No type specified in the request body."),r.status(400).json({error:"Type is required"});if(!t&&!s)return console.error("No IP address or target provided in the request body."),r.status(400).json({error:"IP address or target is required"});try{if("shodan"===n){let e=`https://api.shodan.io/shodan/host/${t}?key=${h.shodanApiKey}`,s=await (0,l.default)(e);if(!s.ok){let e=await s.text();throw Error(`Shodan API error: ${s.status} - ${e}`)}let o=await s.json();return r.status(200).json(o)}if("scan"===n){let e="masscan_results.txt",t="nmap_results.xml";(0,o.exec)(`sudo masscan ${s} -p80,443,22 --rate=100000 -oG ${e}`,s=>{if(s)return console.error("Masscan failed:",s),r.status(500).json({error:"Masscan failed"});a().readFile(e,"utf8",(e,s)=>{if(e)return console.error("Failed to read Masscan output:",e),r.status(500).json({error:"Failed to read Masscan output"});let n=s.match(/\d+\.\d+\.\d+\.\d+/g)||[];if(!n.length)return r.json({message:"No open ports found"});a().writeFileSync("ips.txt",n.join("\n")),(0,o.exec)(`nmap -sV -iL ips.txt -oX ${t}`,e=>{if(e)return console.error("Nmap failed:",e),r.status(500).json({error:"Nmap failed"});a().readFile(t,(e,t)=>{if(e)return console.error("Failed to read Nmap results:",e),r.status(500).json({error:"Failed to read Nmap results"});u().parseString(t,(e,t)=>{if(e)return console.error("Failed to parse Nmap results:",e),r.status(500).json({error:"Failed to parse Nmap results"});let s=[];return(t.nmaprun.host||[]).forEach(e=>{let r=e.address?.[0]?.$.addr||"unknown";(e.ports?.[0]?.port||[]).forEach(e=>{s.push({ip:r,port:e.$.portid,service:e.service?.[0]?.$.name||"unknown"})})}),r.status(200).json({results:s})})})})})});return}if("whois"===n){let e=await p()(t);return r.status(200).json({whoisData:e})}return r.status(400).json({error:"Invalid type specified"})}catch(e){console.error("Error processing request:",e.message),r.status(500).json({error:"Internal server error"})}}else console.error("Invalid HTTP method:",e.method),r.status(405).json({error:"Method not allowed"})}s()}catch(e){s(e)}})},818:e=>{e.exports=require("dotenv")},3480:(e,r,t)=>{e.exports=t(5600)},5035:e=>{e.exports=import("node-fetch")},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6435:(e,r)=>{Object.defineProperty(r,"M",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},6566:e=>{e.exports=require("xml2js")},7129:e=>{e.exports=require("whois-json")},8586:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{config:()=>p,default:()=>d,routeModule:()=>l});var o=t(3480),n=t(8667),a=t(6435),i=t(21),u=e([i]);i=(u.then?(await u)():u)[0];let d=(0,a.M)(i,"default"),p=(0,a.M)(i,"config"),l=new o.PagesAPIRouteModule({definition:{kind:n.A.PAGES_API,page:"/api/proxy",pathname:"/api/proxy",bundlePath:"",filename:""},userland:i});s()}catch(e){s(e)}})},8667:(e,r)=>{Object.defineProperty(r,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},9021:e=>{e.exports=require("fs")},9646:e=>{e.exports=require("child_process")}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=r(r.s=8586);module.exports=t})();