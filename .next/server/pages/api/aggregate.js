"use strict";(()=>{var e={};e.id=160,e.ids=[160],e.modules={2492:(e,n,t)=>{t.a(e,async(e,o)=>{try{t.r(n),t.d(n,{default:()=>a});var r=t(5035),s=e([r]);async function a(e,n){if("POST"!==e.method)return n.status(405).json({error:"Method not allowed"});let{ip:t}=e.body;if(!t)return n.status(400).json({error:"IP address is required"});try{let[e,o,s,a]=await Promise.all([(0,r.default)(`https://ipinfo.io/${t}?token=${process.env.IPINFO_TOKEN}`).then(e=>e.json()),(0,r.default)(`https://api.greynoise.io/v3/community/${t}`,{headers:{key:process.env.GREYNOISE_API_KEY}}).then(e=>e.json()),(0,r.default)(`https://search.censys.io/api/v2/hosts/${t}`,{headers:{Authorization:`Bearer ${process.env.CENSYS_API_KEY}`}}).then(e=>e.json()),(0,r.default)(`https://api.shodan.io/shodan/host/${t}?key=${process.env.SHODAN_API_KEY}`).then(e=>e.json())]),i={ip:t||"Unknown IP",ipinfo:{country:e.country||"Unknown Country",city:e.city||"Unknown City",region:e.region||"Unknown Region",org:e.org||"Unknown Organization",loc:e.loc||"Unknown Location"},greynoise:{noise:o.noise||!1,classification:o.classification||"Unknown",name:o.name||"No Name"},censys:{hostInfo:s.result||"No Host Info",certificates:s.certificates||"No Certificates"},shodan:{ports:a.ports||[],vulns:a.vulns||[],isp:a.isp||"Unknown ISP",org:a.org||"Unknown Organization",asn:a.asn||"Unknown ASN"}};n.status(200).json(i)}catch(e){console.error("Error fetching data:",e),n.status(500).json({error:"Failed to fetch data from one or more sources."})}}r=(s.then?(await s)():s)[0],o()}catch(e){o(e)}})},3480:(e,n,t)=>{e.exports=t(5600)},5035:e=>{e.exports=import("node-fetch")},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6435:(e,n)=>{Object.defineProperty(n,"M",{enumerable:!0,get:function(){return function e(n,t){return t in n?n[t]:"then"in n&&"function"==typeof n.then?n.then(n=>e(n,t)):"function"==typeof n&&"default"===t?n:void 0}}})},7364:(e,n,t)=>{t.a(e,async(e,o)=>{try{t.r(n),t.d(n,{config:()=>d,default:()=>u,routeModule:()=>f});var r=t(3480),s=t(8667),a=t(6435),i=t(2492),c=e([i]);i=(c.then?(await c)():c)[0];let u=(0,a.M)(i,"default"),d=(0,a.M)(i,"config"),f=new r.PagesAPIRouteModule({definition:{kind:s.A.PAGES_API,page:"/api/aggregate",pathname:"/api/aggregate",bundlePath:"",filename:""},userland:i});o()}catch(e){o(e)}})},8667:(e,n)=>{Object.defineProperty(n,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var n=require("../../webpack-api-runtime.js");n.C(e);var t=n(n.s=7364);module.exports=t})();